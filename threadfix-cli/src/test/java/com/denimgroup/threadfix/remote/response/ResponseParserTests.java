package com.denimgroup.threadfix.remote.response;

import com.denimgroup.threadfix.data.entities.Application;
import com.denimgroup.threadfix.data.entities.VulnerabilityMarker;
import com.denimgroup.threadfix.data.interfaces.Endpoint;
import org.junit.Test;

import static junit.framework.Assert.assertFalse;
import static junit.framework.Assert.assertTrue;

public class ResponseParserTests {

    @Test
    public void testBasicParsing() {
        //String
    }

    @Test
    public void testAppInfoParsing() {
        String testString = "{\"object\":[{\"applicationId\":\"1\",\"organizationName\":\"test\",\"applicationName\":\"test\"},{\"applicationId\":\"2\",\"organizationName\":\"test\",\"applicationName\":\"test2\"},{\"applicationId\":\"3\",\"organizationName\":\"team2\",\"applicationName\":\"testteam2\"}],\"message\":null,\"success\":true}";

        RestResponse<Application.Info[]> response = ResponseParser.getRestResponse(testString, 200, Application.Info[].class);

        assertFalse("Response was null.", response == null);

        assertTrue("Wrong number of objects was parsed. " + response.object.length +
                " instead of 3.", response.object.length == 3);
        assertTrue("App ID was " + response.object[0].applicationId + " instead of 1",
                response.object[0].applicationId.equals("1"));
        assertTrue("Response's organizationName was " + response.object[0].organizationName +
                " instead of test.", response.object[0].organizationName.equals("test"));
        assertTrue("Response's applicationName was " + response.object[0].applicationName +
                " instead of test.", response.object[0].applicationName.equals("test"));
        assertTrue("response.success was false.", response.success);
    }

    // TODO improve this
    @Test
    public void testStringObjectParsing() {
        String testString = "{\"object\":\"This is some test text.\",\"message\":null,\"success\":true}";
        String objectString = "\"This is some test text.\"";

        RestResponse<String> response = ResponseParser.getRestResponse(testString, 200, String.class);

        assertFalse("Response was null.", response == null);

        assertTrue("Response string was null.", response.object != null);
    }

    // TODO improve this
    @Test
    public void testParseAnythingAsStringParsing() {
        String testString = "{\"message\":\"Failed to parse REST response.\",\"success\":true,\"responseCode\":-1,\"object\":[{\"parameters\":[\"lastName\",\"address\",\"pet\",\"pet.type\",\"pet.type.name\",\"pet.id\",\"firstName\",\"pet.name\",\"telephone\",\"pet.type.id\",\"pet.owner\",\"pet.birthDate\",\"city\"],\"urlPath\":\"/owners\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/owners,[lastName address pet pet.type pet.type.name pet.id firstName pet.name telephone pet.type.id pet.owner pet.birthDate city]\",\"startingLineNumber\":84},{\"parameters\":[\"ownerId\"],\"urlPath\":\"/owners/{id}\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/owners/{id},[ownerId]\",\"startingLineNumber\":134},{\"parameters\":[\"ownerId\"],\"urlPath\":\"/owners/{id}/edit\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/owners/{id}/edit,[ownerId]\",\"startingLineNumber\":110},{\"parameters\":[\"lastName\",\"address\",\"pet\",\"pet.type\",\"pet.type.name\",\"pet.id\",\"firstName\",\"pet.name\",\"telephone\",\"pet.type.id\",\"pet.owner\",\"pet.birthDate\",\"city\"],\"urlPath\":\"/owners/{id}/edit\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"httpMethods\":[\"PUT\"],\"csvLine\":\"[PUT],/owners/{id}/edit,[lastName address pet pet.type pet.type.name pet.id firstName pet.name telephone pet.type.id pet.owner pet.birthDate city]\",\"startingLineNumber\":117},{\"parameters\":[\"petId\"],\"urlPath\":\"/owners/{id}/pets/{id}/visits\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/VisitController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/owners/{id}/pets/{id}/visits,[petId]\",\"startingLineNumber\":79},{\"parameters\":[],\"urlPath\":\"/owners/find\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/owners/find,[]\",\"startingLineNumber\":78},{\"parameters\":[\"petId\"],\"urlPath\":\"/owners/{id}/pets/{id}/visits/new\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/VisitController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/owners/{id}/pets/{id}/visits/new,[petId]\",\"startingLineNumber\":59},{\"parameters\":[\"pet.owner.pet.owner.pet\",\"pet.owner.pet.owner.pet.type.name\",\"pet.type\",\"pet.owner.pet.owner.pet.type\",\"pet.name\",\"date\",\"pet.owner.pet.type\",\"pet.owner.city\",\"pet.owner.pet.owner\",\"pet.owner.pet.type.id\",\"pet.owner.telephone\",\"pet.owner.pet.owner.lastName\",\"pet.owner.pet.owner.pet.birthDate\",\"description\",\"pet.owner.pet.owner.pet.type.id\",\"pet.id\",\"pet.owner.pet.owner.pet.name\",\"pet.owner.pet.type.name\",\"pet.owner.lastName\",\"pet.owner.pet\",\"pet.owner.pet.owner.id\",\"pet.owner.id\",\"pet.owner.pet.name\",\"pet.owner.pet.birthDate\",\"pet.owner.firstName\",\"pet.owner.pet.owner.telephone\",\"pet.owner.address\",\"pet.owner.pet.owner.pet.id\",\"pet.owner.pet.owner.address\",\"pet\",\"pet.type.name\",\"pet.owner.pet.id\",\"pet.type.id\",\"pet.owner\",\"pet.owner.pet.owner.city\",\"pet.owner.pet.owner.pet.owner\",\"pet.birthDate\",\"pet.owner.pet.owner.firstName\"],\"urlPath\":\"/owners/{id}/pets/{id}/visits/new\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/VisitController.java\",\"httpMethods\":[\"POST\"],\"csvLine\":\"[POST],/owners/{id}/pets/{id}/visits/new,[pet.owner.pet.owner.pet pet.owner.pet.owner.pet.type.name pet.type pet.owner.pet.owner.pet.type pet.name date pet.owner.pet.type pet.owner.city pet.owner.pet.owner pet.owner.pet.type.id pet.owner.telephone pet.owner.pet.owner.lastName pet.owner.pet.owner.pet.birthDate description pet.owner.pet.owner.pet.type.id pet.id pet.owner.pet.owner.pet.name pet.owner.pet.type.name pet.owner.lastName pet.owner.pet pet.owner.pet.owner.id pet.owner.id pet.owner.pet.name pet.owner.pet.birthDate pet.owner.firstName pet.owner.pet.owner.telephone pet.owner.address pet.owner.pet.owner.pet.id pet.owner.pet.owner.address pet pet.type.name pet.owner.pet.id pet.type.id pet.owner pet.owner.pet.owner.city pet.owner.pet.owner.pet.owner pet.birthDate pet.owner.pet.owner.firstName]\",\"startingLineNumber\":68},{\"parameters\":[],\"urlPath\":\"/oups\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/CrashController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/oups,[]\",\"startingLineNumber\":33},{\"parameters\":[\"petId\"],\"urlPath\":\"/owners/{id}/pets/{id}/edit\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/PetController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/owners/{id}/pets/{id}/edit,[petId]\",\"startingLineNumber\":85},{\"parameters\":[\"owner.pet.owner.lastName\",\"owner.pet.type\",\"owner.pet.owner.pet.type.id\",\"owner.city\",\"owner.pet.owner.pet.type.name\",\"type\",\"owner.pet.owner.firstName\",\"owner.id\",\"owner.pet.owner.id\",\"owner.pet.id\",\"owner.pet.owner.telephone\",\"owner.pet.owner.pet.owner\",\"name\",\"type.name\",\"owner.pet.owner.address\",\"owner.firstName\",\"birthDate\",\"owner.pet.owner.city\",\"owner.pet.owner.pet.name\",\"owner.pet.owner\",\"owner.pet.birthDate\",\"owner.pet.owner.pet.id\",\"owner.lastName\",\"owner.pet.type.id\",\"owner.pet.owner.pet.type\",\"owner.pet.owner.pet\",\"owner.pet.name\",\"owner.pet\",\"owner.pet.type.name\",\"owner.telephone\",\"owner.address\",\"owner\",\"owner.pet.owner.pet.birthDate\",\"type.id\"],\"urlPath\":\"/owners/{id}/pets/{id}/edit\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/PetController.java\",\"httpMethods\":[\"POST\",\"PUT\"],\"csvLine\":\"[POST PUT],/owners/{id}/pets/{id}/edit,[owner.pet.owner.lastName owner.pet.type owner.pet.owner.pet.type.id owner.city owner.pet.owner.pet.type.name type owner.pet.owner.firstName owner.id owner.pet.owner.id owner.pet.id owner.pet.owner.telephone owner.pet.owner.pet.owner name type.name owner.pet.owner.address owner.firstName birthDate owner.pet.owner.city owner.pet.owner.pet.name owner.pet.owner owner.pet.birthDate owner.pet.owner.pet.id owner.lastName owner.pet.type.id owner.pet.owner.pet.type owner.pet.owner.pet owner.pet.name owner.pet owner.pet.type.name owner.telephone owner.address owner owner.pet.owner.pet.birthDate type.id]\",\"startingLineNumber\":92},{\"parameters\":[],\"urlPath\":\"/vets\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/VetController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/vets,[]\",\"startingLineNumber\":42},{\"parameters\":[],\"urlPath\":\"/owners/new\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/owners/new,[]\",\"startingLineNumber\":60},{\"parameters\":[\"lastName\",\"address\",\"pet\",\"pet.type\",\"pet.type.name\",\"pet.id\",\"firstName\",\"pet.name\",\"telephone\",\"pet.type.id\",\"pet.owner\",\"pet.birthDate\",\"city\"],\"urlPath\":\"/owners/new\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"httpMethods\":[\"POST\"],\"csvLine\":\"[POST],/owners/new,[lastName address pet pet.type pet.type.name pet.id firstName pet.name telephone pet.type.id pet.owner pet.birthDate city]\",\"startingLineNumber\":67},{\"parameters\":[\"ownerId\"],\"urlPath\":\"/owners/{id}/pets/new\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/PetController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/owners/{id}/pets/new,[ownerId]\",\"startingLineNumber\":64},{\"parameters\":[\"owner.pet.owner\",\"owner.pet.birthDate\",\"owner.pet.type\",\"owner.city\",\"owner.lastName\",\"owner.pet.type.id\",\"type\",\"owner.pet.name\",\"owner.id\",\"owner.pet\",\"owner.pet.type.name\",\"owner.telephone\",\"owner.pet.id\",\"owner.address\",\"name\",\"type.name\",\"owner\",\"owner.firstName\",\"birthDate\",\"type.id\"],\"urlPath\":\"/owners/{id}/pets/new\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/PetController.java\",\"httpMethods\":[\"POST\"],\"csvLine\":\"[POST],/owners/{id}/pets/new,[owner.pet.owner owner.pet.birthDate owner.pet.type owner.city owner.lastName owner.pet.type.id type owner.pet.name owner.id owner.pet owner.pet.type.name owner.telephone owner.pet.id owner.address name type.name owner owner.firstName birthDate type.id]\",\"startingLineNumber\":73}]}";
        String objectString = "[{\"applicationId\":\"1\",\"organizationName\":\"test\",\"applicationName\":\"test\"},{\"applicationId\":\"2\",\"organizationName\":\"test\",\"applicationName\":\"test2\"},{\"applicationId\":\"3\",\"organizationName\":\"team2\",\"applicationName\":\"testteam2\"}]";
        RestResponse response = ResponseParser.getRestResponse(testString, 200, RestResponse.class);

        assertFalse("Response was null.", response == null);

        assertTrue("Response string was null.", response.getObjectAsJsonString() != null);
    }
    
    @Test
    public void testParseEndpointsFormat() {
        String testString = "{\"message\":\"Failed to parse REST response.\",\"success\":true,\"responseCode\":-1,\"object\":[{\"parameters\":[\"lastName\",\"address\",\"pet\",\"pet.type\",\"pet.type.name\",\"pet.id\",\"firstName\",\"pet.name\",\"telephone\",\"pet.type.id\",\"pet.owner\",\"pet.birthDate\",\"city\"],\"urlPath\":\"/owners\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/owners,[lastName address pet pet.type pet.type.name pet.id firstName pet.name telephone pet.type.id pet.owner pet.birthDate city]\",\"startingLineNumber\":84},{\"parameters\":[\"ownerId\"],\"urlPath\":\"/owners/{id}\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/owners/{id},[ownerId]\",\"startingLineNumber\":134},{\"parameters\":[\"ownerId\"],\"urlPath\":\"/owners/{id}/edit\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/owners/{id}/edit,[ownerId]\",\"startingLineNumber\":110},{\"parameters\":[\"lastName\",\"address\",\"pet\",\"pet.type\",\"pet.type.name\",\"pet.id\",\"firstName\",\"pet.name\",\"telephone\",\"pet.type.id\",\"pet.owner\",\"pet.birthDate\",\"city\"],\"urlPath\":\"/owners/{id}/edit\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"httpMethods\":[\"PUT\"],\"csvLine\":\"[PUT],/owners/{id}/edit,[lastName address pet pet.type pet.type.name pet.id firstName pet.name telephone pet.type.id pet.owner pet.birthDate city]\",\"startingLineNumber\":117},{\"parameters\":[\"petId\"],\"urlPath\":\"/owners/{id}/pets/{id}/visits\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/VisitController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/owners/{id}/pets/{id}/visits,[petId]\",\"startingLineNumber\":79},{\"parameters\":[],\"urlPath\":\"/owners/find\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/owners/find,[]\",\"startingLineNumber\":78},{\"parameters\":[\"petId\"],\"urlPath\":\"/owners/{id}/pets/{id}/visits/new\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/VisitController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/owners/{id}/pets/{id}/visits/new,[petId]\",\"startingLineNumber\":59},{\"parameters\":[\"pet.owner.pet.owner.pet\",\"pet.owner.pet.owner.pet.type.name\",\"pet.type\",\"pet.owner.pet.owner.pet.type\",\"pet.name\",\"date\",\"pet.owner.pet.type\",\"pet.owner.city\",\"pet.owner.pet.owner\",\"pet.owner.pet.type.id\",\"pet.owner.telephone\",\"pet.owner.pet.owner.lastName\",\"pet.owner.pet.owner.pet.birthDate\",\"description\",\"pet.owner.pet.owner.pet.type.id\",\"pet.id\",\"pet.owner.pet.owner.pet.name\",\"pet.owner.pet.type.name\",\"pet.owner.lastName\",\"pet.owner.pet\",\"pet.owner.pet.owner.id\",\"pet.owner.id\",\"pet.owner.pet.name\",\"pet.owner.pet.birthDate\",\"pet.owner.firstName\",\"pet.owner.pet.owner.telephone\",\"pet.owner.address\",\"pet.owner.pet.owner.pet.id\",\"pet.owner.pet.owner.address\",\"pet\",\"pet.type.name\",\"pet.owner.pet.id\",\"pet.type.id\",\"pet.owner\",\"pet.owner.pet.owner.city\",\"pet.owner.pet.owner.pet.owner\",\"pet.birthDate\",\"pet.owner.pet.owner.firstName\"],\"urlPath\":\"/owners/{id}/pets/{id}/visits/new\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/VisitController.java\",\"httpMethods\":[\"POST\"],\"csvLine\":\"[POST],/owners/{id}/pets/{id}/visits/new,[pet.owner.pet.owner.pet pet.owner.pet.owner.pet.type.name pet.type pet.owner.pet.owner.pet.type pet.name date pet.owner.pet.type pet.owner.city pet.owner.pet.owner pet.owner.pet.type.id pet.owner.telephone pet.owner.pet.owner.lastName pet.owner.pet.owner.pet.birthDate description pet.owner.pet.owner.pet.type.id pet.id pet.owner.pet.owner.pet.name pet.owner.pet.type.name pet.owner.lastName pet.owner.pet pet.owner.pet.owner.id pet.owner.id pet.owner.pet.name pet.owner.pet.birthDate pet.owner.firstName pet.owner.pet.owner.telephone pet.owner.address pet.owner.pet.owner.pet.id pet.owner.pet.owner.address pet pet.type.name pet.owner.pet.id pet.type.id pet.owner pet.owner.pet.owner.city pet.owner.pet.owner.pet.owner pet.birthDate pet.owner.pet.owner.firstName]\",\"startingLineNumber\":68},{\"parameters\":[],\"urlPath\":\"/oups\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/CrashController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/oups,[]\",\"startingLineNumber\":33},{\"parameters\":[\"petId\"],\"urlPath\":\"/owners/{id}/pets/{id}/edit\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/PetController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/owners/{id}/pets/{id}/edit,[petId]\",\"startingLineNumber\":85},{\"parameters\":[\"owner.pet.owner.lastName\",\"owner.pet.type\",\"owner.pet.owner.pet.type.id\",\"owner.city\",\"owner.pet.owner.pet.type.name\",\"type\",\"owner.pet.owner.firstName\",\"owner.id\",\"owner.pet.owner.id\",\"owner.pet.id\",\"owner.pet.owner.telephone\",\"owner.pet.owner.pet.owner\",\"name\",\"type.name\",\"owner.pet.owner.address\",\"owner.firstName\",\"birthDate\",\"owner.pet.owner.city\",\"owner.pet.owner.pet.name\",\"owner.pet.owner\",\"owner.pet.birthDate\",\"owner.pet.owner.pet.id\",\"owner.lastName\",\"owner.pet.type.id\",\"owner.pet.owner.pet.type\",\"owner.pet.owner.pet\",\"owner.pet.name\",\"owner.pet\",\"owner.pet.type.name\",\"owner.telephone\",\"owner.address\",\"owner\",\"owner.pet.owner.pet.birthDate\",\"type.id\"],\"urlPath\":\"/owners/{id}/pets/{id}/edit\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/PetController.java\",\"httpMethods\":[\"POST\",\"PUT\"],\"csvLine\":\"[POST PUT],/owners/{id}/pets/{id}/edit,[owner.pet.owner.lastName owner.pet.type owner.pet.owner.pet.type.id owner.city owner.pet.owner.pet.type.name type owner.pet.owner.firstName owner.id owner.pet.owner.id owner.pet.id owner.pet.owner.telephone owner.pet.owner.pet.owner name type.name owner.pet.owner.address owner.firstName birthDate owner.pet.owner.city owner.pet.owner.pet.name owner.pet.owner owner.pet.birthDate owner.pet.owner.pet.id owner.lastName owner.pet.type.id owner.pet.owner.pet.type owner.pet.owner.pet owner.pet.name owner.pet owner.pet.type.name owner.telephone owner.address owner owner.pet.owner.pet.birthDate type.id]\",\"startingLineNumber\":92},{\"parameters\":[],\"urlPath\":\"/vets\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/VetController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/vets,[]\",\"startingLineNumber\":42},{\"parameters\":[],\"urlPath\":\"/owners/new\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/owners/new,[]\",\"startingLineNumber\":60},{\"parameters\":[\"lastName\",\"address\",\"pet\",\"pet.type\",\"pet.type.name\",\"pet.id\",\"firstName\",\"pet.name\",\"telephone\",\"pet.type.id\",\"pet.owner\",\"pet.birthDate\",\"city\"],\"urlPath\":\"/owners/new\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"httpMethods\":[\"POST\"],\"csvLine\":\"[POST],/owners/new,[lastName address pet pet.type pet.type.name pet.id firstName pet.name telephone pet.type.id pet.owner pet.birthDate city]\",\"startingLineNumber\":67},{\"parameters\":[\"ownerId\"],\"urlPath\":\"/owners/{id}/pets/new\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/PetController.java\",\"httpMethods\":[\"GET\"],\"csvLine\":\"[GET],/owners/{id}/pets/new,[ownerId]\",\"startingLineNumber\":64},{\"parameters\":[\"owner.pet.owner\",\"owner.pet.birthDate\",\"owner.pet.type\",\"owner.city\",\"owner.lastName\",\"owner.pet.type.id\",\"type\",\"owner.pet.name\",\"owner.id\",\"owner.pet\",\"owner.pet.type.name\",\"owner.telephone\",\"owner.pet.id\",\"owner.address\",\"name\",\"type.name\",\"owner\",\"owner.firstName\",\"birthDate\",\"type.id\"],\"urlPath\":\"/owners/{id}/pets/new\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/PetController.java\",\"httpMethods\":[\"POST\"],\"csvLine\":\"[POST],/owners/{id}/pets/new,[owner.pet.owner owner.pet.birthDate owner.pet.type owner.city owner.lastName owner.pet.type.id type owner.pet.name owner.id owner.pet owner.pet.type.name owner.telephone owner.pet.id owner.address name type.name owner owner.firstName birthDate type.id]\",\"startingLineNumber\":73}]}";

        RestResponse<Endpoint.Info[]> endpoints = ResponseParser.getRestResponse(testString, 200, Endpoint.Info[].class);

        assertTrue(endpoints.object != null);
    }

    @Test
    public void testParseMarkersFormat() {
        String testString = "{\"message\":\"Failed to parse REST response.\",\"success\":true,\"responseCode\":-1,\"object\":[{\"lineNumber\":\"-1\",\"parameter\":\"new\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"79\",\"genericVulnName\":\"Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\",\"defectId\":null},{\"lineNumber\":\"92\",\"parameter\":\"name\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/PetController.java\",\"defectUrl\":null,\"genericVulnId\":\"79\",\"genericVulnName\":\"Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\",\"defectId\":null},{\"lineNumber\":\"84\",\"parameter\":\"lastName\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"defectUrl\":null,\"genericVulnId\":\"79\",\"genericVulnName\":\"Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')\",\"defectId\":null},{\"lineNumber\":\"68\",\"parameter\":\"description\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/VisitController.java\",\"defectUrl\":null,\"genericVulnId\":\"89\",\"genericVulnName\":\"Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\",\"defectId\":null},{\"lineNumber\":\"73\",\"parameter\":\"birthDate\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/PetController.java\",\"defectUrl\":null,\"genericVulnId\":\"89\",\"genericVulnName\":\"Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\",\"defectId\":null},{\"lineNumber\":\"92\",\"parameter\":\"type\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/PetController.java\",\"defectUrl\":null,\"genericVulnId\":\"89\",\"genericVulnName\":\"Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\",\"defectId\":null},{\"lineNumber\":\"117\",\"parameter\":\"lastName\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"defectUrl\":null,\"genericVulnId\":\"89\",\"genericVulnName\":\"Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\",\"defectId\":null},{\"lineNumber\":\"92\",\"parameter\":\"name\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/PetController.java\",\"defectUrl\":null,\"genericVulnId\":\"89\",\"genericVulnName\":\"Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\",\"defectId\":null},{\"lineNumber\":\"117\",\"parameter\":\"firstName\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"defectUrl\":null,\"genericVulnId\":\"89\",\"genericVulnName\":\"Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\",\"defectId\":null},{\"lineNumber\":\"84\",\"parameter\":\"lastName\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"defectUrl\":null,\"genericVulnId\":\"89\",\"genericVulnName\":\"Improper Neutralization of Special Elements used in an SQL Command ('SQL Injection')\",\"defectId\":null},{\"lineNumber\":\"84\",\"parameter\":\"lastName\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"defectUrl\":null,\"genericVulnId\":\"74\",\"genericVulnName\":\"Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')\",\"defectId\":null},{\"lineNumber\":\"84\",\"parameter\":\"lastName\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"defectUrl\":null,\"genericVulnId\":\"301\",\"genericVulnName\":\"Reflection Attack in an Authentication Protocol\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"6\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"20\",\"genericVulnName\":\"Improper Input Validation\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"9\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"20\",\"genericVulnName\":\"Improper Input Validation\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"new\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"20\",\"genericVulnName\":\"Improper Input Validation\",\"defectId\":null},{\"lineNumber\":\"84\",\"parameter\":\"lastName\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"defectUrl\":null,\"genericVulnId\":\"209\",\"genericVulnName\":\"Information Exposure Through an Error Message\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"9\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"531\",\"genericVulnName\":\"Information Exposure Through Test Code\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"6\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"531\",\"genericVulnName\":\"Information Exposure Through Test Code\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"new\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"531\",\"genericVulnName\":\"Information Exposure Through Test Code\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"/*! jQuery UI - v1.9.2 - 2012-11-23\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"129\",\"genericVulnName\":\"Improper Validation of Array Index\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"id\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"550\",\"genericVulnName\":\"Information Exposure Through Server Error Message\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"t\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"550\",\"genericVulnName\":\"Information Exposure Through Server Error Message\",\"defectId\":null},{\"lineNumber\":\"84\",\"parameter\":\"lastName\",\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/OwnerController.java\",\"defectUrl\":null,\"genericVulnId\":\"550\",\"genericVulnName\":\"Information Exposure Through Server Error Message\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"id\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"550\",\"genericVulnName\":\"Information Exposure Through Server Error Message\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"t\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"550\",\"genericVulnName\":\"Information Exposure Through Server Error Message\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"t\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"550\",\"genericVulnName\":\"Information Exposure Through Server Error Message\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"t\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"550\",\"genericVulnName\":\"Information Exposure Through Server Error Message\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"dti\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"550\",\"genericVulnName\":\"Information Exposure Through Server Error Message\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"id\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"550\",\"genericVulnName\":\"Information Exposure Through Server Error Message\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"c\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"550\",\"genericVulnName\":\"Information Exposure Through Server Error Message\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"c\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"550\",\"genericVulnName\":\"Information Exposure Through Server Error Message\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"c\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"550\",\"genericVulnName\":\"Information Exposure Through Server Error Message\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"c\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"550\",\"genericVulnName\":\"Information Exposure Through Server Error Message\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"id\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"550\",\"genericVulnName\":\"Information Exposure Through Server Error Message\",\"defectId\":null},{\"lineNumber\":\"-1\",\"parameter\":\"dtt\",\"filePath\":null,\"defectUrl\":null,\"genericVulnId\":\"550\",\"genericVulnName\":\"Information Exposure Through Server Error Message\",\"defectId\":null},{\"lineNumber\":\"68\",\"parameter\":null,\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/VisitController.java\",\"defectUrl\":null,\"genericVulnId\":\"615\",\"genericVulnName\":\"Information Exposure Through Comments\",\"defectId\":null},{\"lineNumber\":\"73\",\"parameter\":null,\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/PetController.java\",\"defectUrl\":null,\"genericVulnId\":\"615\",\"genericVulnName\":\"Information Exposure Through Comments\",\"defectId\":null},{\"lineNumber\":\"68\",\"parameter\":null,\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/VisitController.java\",\"defectUrl\":null,\"genericVulnId\":\"615\",\"genericVulnName\":\"Information Exposure Through Comments\",\"defectId\":null},{\"lineNumber\":\"92\",\"parameter\":null,\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/PetController.java\",\"defectUrl\":null,\"genericVulnId\":\"615\",\"genericVulnName\":\"Information Exposure Through Comments\",\"defectId\":null},{\"lineNumber\":\"68\",\"parameter\":null,\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/VisitController.java\",\"defectUrl\":null,\"genericVulnId\":\"615\",\"genericVulnName\":\"Information Exposure Through Comments\",\"defectId\":null},{\"lineNumber\":\"33\",\"parameter\":null,\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/CrashController.java\",\"defectUrl\":null,\"genericVulnId\":\"615\",\"genericVulnName\":\"Information Exposure Through Comments\",\"defectId\":null},{\"lineNumber\":\"68\",\"parameter\":null,\"filePath\":\"/src/main/java/org/springframework/samples/petclinic/web/VisitController.java\",\"defectUrl\":null,\"genericVulnId\":\"615\",\"genericVulnName\":\"Information Exposure Through Comments\",\"defectId\":null}]}";
        RestResponse<VulnerabilityMarker[]> endpoints = ResponseParser.getRestResponse(testString, 200, VulnerabilityMarker[].class);

        assertTrue(endpoints.object != null);

    }

}
